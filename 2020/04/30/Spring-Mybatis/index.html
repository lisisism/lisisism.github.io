<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <title>
    
    Spring-MyBatis 丨
    

    Lism Blog
  </title>

  
  <link rel="shortcut icon" href="/icon.svg">
  

  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  
  <link id="theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.css">
  <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
  

  <!-- 字体 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">

  
<link rel="stylesheet" href="/css/root.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/post.css">

<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="/Lism Blog" type="application/atom+xml">
</head>

<body>
  <header class="header">
  <section class="header-container">
    <a class="logo" href="/">/Lism Blog</a>
    <ul class="nav">
      
      <li><a href="/archives">archives</a></li>
      
      <li><a href="/about">about</a></li>
      
    </ul>
  </section>
</header>
  <main class="main">
    <article class="post">
  
  <div class="post-title">Spring-MyBatis</div>
  <div class="post-meta">
    <div class="date">2020 四月 30日</div>
    <div class="tags">
      
      <div class="tag-item">Mybatis</div>
      
      <div class="tag-item">Spring</div>
      
    </div>
  </div>
  

  <main class="post-content"><h1 id="spring-mybatis"><a class="markdownIt-Anchor" href="#spring-mybatis"></a> Spring + MyBatis</h1>
<p>[toc]</p>
<h2 id="mybatisspringjar简介"><a class="markdownIt-Anchor" href="#mybatisspringjar简介"></a> Mybatis+Spring.jar简介</h2>
<p>Spring与MyBatis整合需要引入一个<strong>mybatis-spring.jar</strong>文件包，该整合包由mybatis提供，可以从MyBatis官网下载，mybatis-spring.jar提供了下面几个整合相关的API</p>
<ul>
<li>SqlSessionFactoryBean
<ul>
<li>为整合应用提供SqlSession对象资源</li>
</ul>
</li>
<li>MapperFacotyBean
<ul>
<li>根据指定Mapper接口生成Bean实例</li>
</ul>
</li>
<li>MapperScannerConfigurer
<ul>
<li>根据指定包批量扫描Mapper接口并生成实例</li>
</ul>
</li>
</ul>
<h3 id="sqlsessionfactorybean"><a class="markdownIt-Anchor" href="#sqlsessionfactorybean"></a> SqlSessionFactoryBean</h3>
<ul>
<li>在单独使用MyBatis时，所有操作都是围绕SqlSession展开的，SqlSession是通过SqlSessionFactory获取的，SqlSessionFactory又是通过SqlSessionFactoryBuilder创建生成</li>
<li>在Spring和MyBaits整合应用时，同样需要SqlSession，mybatis-spring.jar提供了一个SqlSessionFactoryBean，这个组件作用就是通过原SqlSessionFactoryBuilder生成SqlSessionFactory对象，为整合应用提供SqlSession对象</li>
<li><strong>该对象的作用就是替代SqlSessionFactoryBuilder，用来生成SqlSessionFactory，并纳入spring管理</strong></li>
</ul>
<p><strong>SqlSessionFactoryBean在applicationContext.xml中定义格式如下</strong></p>
<pre><code class="highlight xml"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span>
    <span class="comment">&lt;!--指定连接资源--&gt;</span>
    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;mbDataSource&quot;</span>/&gt;</span>
    <span class="comment">&lt;!--指定映射资源--&gt;</span>
    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:org/tarena/entity/*.xml&quot;</span>/&gt;</span>
<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></code></pre>
<ul>
<li>通过SqlSessionFactoryBean还可以定义一些属性来指定MyBatis框架的配置信息，在定义SqlSessionFacotyBean时，可以使用如下常用属性</li>
</ul>
<table>
<thead>
<tr>
<th>属性名</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>dataSource</td>
<td>用于指定连接数据库的数据源（必要属性）</td>
</tr>
<tr>
<td>mapperLocations</td>
<td>用于指定Mapper文件存放的位置</td>
</tr>
<tr>
<td>configLocation</td>
<td>用于指定Mybatis的配置文件位置，如果指定了该属性，那么会以该配置文件的内容作为配置信息构建对应的SqlSessionFactoryBuilder，但是后续属性指定的内容会覆盖该配置文件里面指定的对应内容</td>
</tr>
<tr>
<td>typeAliasesPackage</td>
<td>它一般对应我们的实体类所在的包，这个时候会自动取对应包中不包括包名的简单类名作为包括包名的别名，多个package之间可以用逗号或者分号等来进行分割</td>
</tr>
<tr>
<td>typeAliased</td>
<td>数组类型，用来指定别名的，指定了这个属性后，MyBatis会把这个类型的短名作为这个类型的别名</td>
</tr>
</tbody>
</table>
<h3 id="mapperfacorybean"><a class="markdownIt-Anchor" href="#mapperfacorybean"></a> MapperFacoryBean</h3>
<ul>
<li>MapperFactoryBean作用时根据Mapper接口获取我们想要的Mapper对象，它封装了原有session.getMapper()功能实现</li>
<li>在定义MapperFactoryBean时，需要注入以下两个属性
<ul>
<li>一个是SqlSessionFactoryBean对象，用于提供SqlSession</li>
<li>一个是要返回Mapper对象的Mapper接口</li>
</ul>
</li>
<li><strong>MapperFactoryBean在applicationContext.xml中定义格式如下</strong></li>
</ul>
<pre><code class="highlight xml"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;deptMapper&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperFactoryBean&quot;</span>&gt;</span>
    <span class="comment">&lt;!-- 指定Mapper接口 --&gt;</span>
    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperInterface&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.tarena.mapper.DeptMapper&quot;</span>/&gt;</span>
    <span class="comment">&lt;!-- 指定SqlSessionFactoryBean对象 --&gt;</span>
    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>/&gt;</span>
<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></code></pre>
<h3 id="mapperscannerconfiguer"><a class="markdownIt-Anchor" href="#mapperscannerconfiguer"></a> MapperScannerConfiguer</h3>
<ul>
<li>在使用MapperFactoryBean时，有一个Mapper就需要定义一个对应的MapperFactoryBean，当Mapper比较少时可以，但是遇到大量Mapper时就需要使用mybatis-spring.jar提供的MapperScannerConfigurer组件，通过这个组件会自动扫描各个Mapper接口，并注册对应的MapperFactoryBean对象</li>
<li>在定义MapperScannerConfigurer时，只需要指定一个basePackage即可，basePackage用于指定Mapper接口所在的包，在这个包极其所有子包下面的mapper接口都将被搜索到，并把他们注册为一个个MapperFactoryBean对象，多个包之间可以使用逗号或者分号进行分隔</li>
</ul>
<pre><code class="highlight xml"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span>
    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.tarena.mapper&quot;</span>/&gt;</span>
<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></code></pre>
<blockquote>
<p>sqlSessionFactory属性可以不用指定，会以Autowired方式自动注入</p>
</blockquote>
<h4 id="如果指定的包并不完全是我们定义的mapper"><a class="markdownIt-Anchor" href="#如果指定的包并不完全是我们定义的mapper"></a> 如果指定的包并不完全是我们定义的Mapper</h4>
<ul>
<li>如果指定的某个包并不完全是我们定义的Mapper接口，此时使用MapperScannerConfigurer的另外两个属性可以缩小搜索和注册范围，一个是annotationClass，另一个是markerInterface</li>
<li><strong>annotationClass</strong>用于指定一个注解标记，当指定了annotationClass时，MapperScannerConfigurer将只注册使用了annotationClass注解标记的接口</li>
<li><strong>markerInterface</strong>用于指定一个接口，当指定了markerInterface时，MapperScannerConfigurer将只注册继承自markerInterface的接口</li>
<li><strong>MapperScannerConfigurer定义示例</strong></li>
</ul>
<pre><code class="highlight xml"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span>
    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.tarena&quot;</span>/&gt;</span>
    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;annotationClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.tarena.annotation.MyBatisRepository&quot;</span>/&gt;</span>
<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></code></pre>
<blockquote>
<p>上面配置含义：MapperScannerConfigurer自动扫描org.tarena包下所有接口，遇到带@MyBatisRespository标记的将对应MapperFactoryBean对象注册</p>
</blockquote>
<ul>
<li><strong>MyBatisRepository自定义注解标记代码如下</strong></li>
</ul>
<pre><code class="highlight java"><span class="keyword">public</span> <span class="meta">@interface</span> MybatisRepository&#123;
&#125;</code></pre>
<h3 id="sqlsessiontemplate"><a class="markdownIt-Anchor" href="#sqlsessiontemplate"></a> SqlSessionTemplate</h3>
<ul>
<li>上述整合完成之后，程序可以直接使用Spring容器中的Mapper接口实例进行编程，此外mybatis-spring.jar还提供了一个SqlSessionTemplate组件，也可将该组件对象注入给程序中的DAO，在DAO中利用SqlSessionTemplate编程</li>
<li><strong>基于SqlSessionTemplate的DAO示例代码如下</strong></li>
</ul>
<pre><code class="highlight java"><span class="meta">@Repository</span>
<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyBatisDeptDao</span> <span class="keyword">implements</span> <span class="title class_">DeptDAO</span>&#123;
    <span class="keyword">private</span> SqlSessionTemplate template;
    <span class="meta">@Autowired</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTemplate</span><span class="params">(SqlSessionTemplate template)</span>&#123;
        <span class="built_in">this</span>.template = template;
    &#125;
    <span class="keyword">public</span> List&lt;Dept&gt; <span class="title function_">findAll</span><span class="params">()</span>&#123;
        LIst&lt;Dept&gt; list = template.selectList(<span class="string">&quot;findAll&quot;</span>);
        <span class="keyword">return</span> list;
    &#125;
&#125;</code></pre>
<ul>
<li><strong>基于SqlSessionTemplate的DAO配置信息如下</strong></li>
</ul>
<pre><code class="highlight xml"><span class="comment">&lt;!-- 定义SqlSessionTemplate --&gt;</span>
<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span>
    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFacotry&quot;</span>&gt;</span>
    <span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span>
<span class="tag">&lt;/<span class="name">bean</span>&gt;</span>
<span class="comment">&lt;!-- 扫描DAO并注入template --&gt;</span>
<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;org.tarena.dao&quot;</span>/&gt;</span>
<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span>
    <span class="comment">&lt;!-- 省略 --&gt;</span>
<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></code></pre>
<h2 id="spring整合mybatis应用"><a class="markdownIt-Anchor" href="#spring整合mybatis应用"></a> Spring整合MyBatis应用</h2>
<h3 id="整合步骤介绍"><a class="markdownIt-Anchor" href="#整合步骤介绍"></a> 整合步骤介绍</h3>
<p><strong>整合思路</strong></p>
<p>spring在java项目中，主要的责任就是对javaBean进行IoC处理（spring容器）</p>
<p>三层结构：业务层、持久层、表现层</p>
<ul>
<li>持久层：DataSource、SqlSessionFactory（单例管理）、<strong>MapperScannerConfigurer</strong></li>
<li>业务层：Service实现类、事务管理</li>
</ul>
<h4 id="maven依赖"><a class="markdownIt-Anchor" href="#maven依赖"></a> maven依赖</h4>
<pre><code class="highlight xml"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span>
    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span>
    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.kkb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ms<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT
    <span class="tag">&lt;/<span class="name">version</span>&gt;</span>
    <span class="comment">&lt;!-- 持久层：mysql驱动、dbcp连接池、mybatis、mybatis和spring整合依赖、spring依赖 --&gt;</span>
    <span class="comment">&lt;!-- 业务层：aop相关依赖 --&gt;</span>
    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span>
        <span class="comment">&lt;!-- spring ioc组件需要的依赖包 --&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-expression<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="comment">&lt;!-- 基于AspectJ的aop依赖 --&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>aopalliance<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aopalliance<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="comment">&lt;!-- spring 事务管理和JDBC依赖包 --&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="comment">&lt;!-- spring 单元测试组件包 --&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="comment">&lt;!-- 单元测试Junit --&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="comment">&lt;!-- mysql数据库驱动包 --&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.35<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="comment">&lt;!-- dbcp连接池的依赖包 --&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-dbcp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-dbcp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="comment">&lt;!-- mybatis依赖 --&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
        <span class="comment">&lt;!-- mybatis和spring的整合依赖 --&gt;</span>
        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>
    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span>
    <span class="tag">&lt;<span class="name">build</span>&gt;</span>
        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span>
            <span class="comment">&lt;!-- 配置Maven的JDK编译级别 --&gt;</span>
            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span>
                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>
                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>
                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span>
                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span>
                    <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span>
                    <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span>
                    <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span>
                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span>
            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span>
        <span class="comment">&lt;!--maven默认不加载xml非resources目录下的xml文件，Mapper文件就无法加载，所以得加上如下配置--&gt;</span>
        <span class="tag">&lt;<span class="name">resources</span>&gt;</span>
            <span class="tag">&lt;<span class="name">resource</span>&gt;</span>
                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span>
                <span class="tag">&lt;<span class="name">includes</span>&gt;</span>
                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span>
                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span>
                <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span>
            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span>
        <span class="tag">&lt;/<span class="name">resources</span>&gt;</span>
    <span class="tag">&lt;/<span class="name">build</span>&gt;</span>
<span class="tag">&lt;/<span class="name">project</span>&gt;</span></code></pre>
<h4 id="spring配置文件"><a class="markdownIt-Anchor" href="#spring配置文件"></a> spring配置文件</h4>
<p>编写配置文件(resources/spring目录下)</p>
<p>db.properties</p>
<pre><code class="highlight properties"><span class="attr">db.driverClassName</span>=<span class="string">com.mysql.jdbc.Driver</span>
<span class="attr">db.url</span>=<span class="string">jdbc:mysql://localhost:3306/leetest?characterEncoding=UTF-8</span>
<span class="attr">db.username</span>=<span class="string">root</span>
<span class="attr">db.password</span>=<span class="string">123456</span></code></pre>
<p>applicationContext-dao.xml:</p>
<pre><code class="highlight xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span>
<span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="string"><span class="tag">           http://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="string"><span class="tag">           http://www.springframework.org/schema/context</span></span>
<span class="string"><span class="tag">           http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span>

    <span class="comment">&lt;!-- 读取java配置文件，替换占位符数据 --&gt;</span>
    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:db.properties&quot;</span>/&gt;</span>
    <span class="comment">&lt;!-- 配置数据源 --&gt;</span>
    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.commons.dbcp.BasicDataSource&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span>
        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;db.driverClassName&#125;&quot;</span>/&gt;</span>
        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;db.url&#125;&quot;</span>/&gt;</span>
        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;db.username&#125;&quot;</span>/&gt;</span>
        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;db.password&#125;&quot;</span>/&gt;</span>
    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>
    <span class="comment">&lt;!-- 配置SqlSessionFactory --&gt;</span>
    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span>
        <span class="comment">&lt;!-- 注入dataSource --&gt;</span>
        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span>
        <span class="comment">&lt;!-- mybatis批量别名配置 --&gt;</span>
        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;typeAliasesPackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.lee.pojo&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span>
        <span class="comment">&lt;!-- 注入mybatis的全局配置文件路径 (该部分可以被省略掉) --&gt;</span>
        <span class="comment">&lt;!-- &lt;property name=&quot;configLocation&quot; value=&quot;mybatis/SqlMapConfig.xml&quot;&gt;&lt;/property&gt; --&gt;</span>
    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>

    <span class="comment">&lt;!-- 相当于配置之前的AccountDao持久层bean --&gt;</span>
    <span class="comment">&lt;!-- 配置Mapper代理对象方式一：MapperFactoryBean --&gt;</span>
    <span class="comment">&lt;!-- 通过MapperFactoryBean生成的代理对象，一次只能针对一个接口进行生成 --&gt;</span>
    <span class="comment">&lt;!-- 注意事项：mapper接口类和mapper映射文件同包同名 --&gt;</span>
<span class="comment">&lt;!--    &lt;bean id=&quot;accountMapper&quot; class=&quot;org.mybatis.spring.mapper.MapperFactoryBean&quot;&gt;--&gt;</span>
<span class="comment">&lt;!--        &amp;lt;!&amp;ndash;注入SqlSessionFactory &amp;ndash;&amp;gt;--&gt;</span>
<span class="comment">&lt;!--        &lt;property name=&quot;sqlSessionFactory&quot; ref=&quot;sqlSessionFactory&quot;&gt;&lt;/property&gt;--&gt;</span>
<span class="comment">&lt;!--        &amp;lt;!&amp;ndash;注入目标接口类 &amp;ndash;&amp;gt;--&gt;</span>
<span class="comment">&lt;!--        &lt;property name=&quot;mapperInterface&quot; value=&quot;com.lee.mapper.AccountMapper&quot;&gt;&lt;/property&gt;--&gt;</span>
<span class="comment">&lt;!--    &lt;/bean&gt;--&gt;</span>
    <span class="comment">&lt;!-- 配置Mapper代理对象方式二：MapperScannerConfigurer --&gt;</span>
    <span class="comment">&lt;!-- 批量代理对象的生成 --&gt;</span>
    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span>
        <span class="comment">&lt;!-- 指定需要生成代理的接口所在的包名 --&gt;</span>
        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.lee.mapper&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span>
        <span class="comment">&lt;!-- 注意事项：不要配置SqlSessionFactory --&gt;</span>
        <span class="comment">&lt;!-- &lt;property name=&quot;sqlSessionFactory&quot; ref=&quot;sqlSessionFactory&quot;&gt;&lt;/property&gt; --&gt;</span>
        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactoryBeanName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span>
    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>
<span class="tag">&lt;/<span class="name">beans</span>&gt;</span></code></pre>
<p>applicationContext-service.xml</p>
<pre><code class="highlight xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span>
<span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="string"><span class="tag">           http://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="string"><span class="tag">           http://www.springframework.org/schema/context</span></span>
<span class="string"><span class="tag">           http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span>
    <span class="comment">&lt;!-- 扫描业务bean --&gt;</span>
    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.lee.service&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span>
<span class="tag">&lt;/<span class="name">beans</span>&gt;</span></code></pre>
<p>applicationContext-tx.xml</p>
<pre><code class="highlight xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span>
<span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span> <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span>
<span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span>
    <span class="comment">&lt;!-- 配置平台事务管理器 --&gt;</span>
    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span>
        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span>
    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>
    <span class="comment">&lt;!--事务通知--&gt;</span>
    <span class="comment">&lt;!--tx:advice：对应的处理器类就是TransactionInterceptor类（实现MethodInterceptor环绕通知接口）--&gt;</span>
    <span class="comment">&lt;!--TransactionInterceptor类实现事务是通过transaction-manager属性指定的值实现事务管理的--&gt;</span>
    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span>
        <span class="comment">&lt;!--设置事务管理信息--&gt;</span>
        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span>
            <span class="comment">&lt;!--增删改使用REQUIRED事务传播行为--&gt;</span>
            <span class="comment">&lt;!--查询使用read-only --&gt;</span>
            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;transfor*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;DEFAULT&quot;</span>/&gt;</span>
        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span>
    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span>
    <span class="comment">&lt;!-- 基于AspectJ + XML方式实现声明式事务 --&gt;</span>
    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span>
        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">pointcut</span>=<span class="string">&quot;execution(* *..*.*ServiceImpl.*(..))&quot;</span>/&gt;</span>
    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span>
<span class="tag">&lt;/<span class="name">beans</span>&gt;</span></code></pre>
<h4 id="mapper接口"><a class="markdownIt-Anchor" href="#mapper接口"></a> mapper接口</h4>
<p>注意：该类必须和mapper.xml在<strong>同一个包中</strong>，并且<strong>名字要相同</strong>，mapper.xml中的<strong>namespace要为mapper接口的完整路径</strong>，<strong>方法名要和mapper.xml中的子标签id相同</strong></p>
<blockquote>
<p>mapper接口中不用写纳入spring管理的@标签</p>
</blockquote>
<pre><code class="highlight java"><span class="keyword">package</span> com.lee.mapper;

<span class="keyword">import</span> org.apache.ibatis.annotations.Param;

<span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountMapper</span>&#123;

    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">queryMoney</span><span class="params">(String name)</span>;

    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateAccount</span><span class="params">(<span class="meta">@Param(&quot;name&quot;)</span> String name,<span class="meta">@Param(&quot;money&quot;)</span> <span class="type">double</span> money)</span>;
&#125;
</code></pre>
<pre><code class="highlight xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span>
<span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span>
<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.lee.mapper.AccountMapper&quot;</span>&gt;</span>
    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryMoney&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;string&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;double&quot;</span>&gt;</span>
        select money from account where name= #&#123;name&#125;
    <span class="tag">&lt;/<span class="name">select</span>&gt;</span>

    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateAccount&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span>&gt;</span>
        update account set money = #&#123;money&#125; where name = #&#123;name&#125;
    <span class="tag">&lt;/<span class="name">update</span>&gt;</span>
<span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></code></pre>
<h4 id="service层"><a class="markdownIt-Anchor" href="#service层"></a> service层</h4>
<pre><code class="highlight java"><span class="keyword">package</span> com.lee.service;

<span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountService</span> &#123;    
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfor</span><span class="params">(String from,String to,<span class="type">double</span> money)</span>;
&#125;</code></pre>
<pre><code class="highlight java"><span class="keyword">package</span> com.lee.service;

<span class="keyword">import</span> com.lee.mapper.AccountMapper;
<span class="keyword">import</span> org.springframework.stereotype.Service;

<span class="keyword">import</span> javax.annotation.Resource;

<span class="meta">@Service</span>
<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;
    <span class="meta">@Resource</span>
    AccountMapper mapper;
    
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfor</span><span class="params">(String from, String to, <span class="type">double</span> money)</span> &#123;
        <span class="type">double</span> <span class="variable">money1</span> <span class="operator">=</span> mapper.queryMoney(from);
        mapper.updateAccount(from,money1-money);
        System.out.println(<span class="number">1</span>/<span class="number">0</span>);
        <span class="type">double</span> <span class="variable">money2</span> <span class="operator">=</span> mapper.queryMoney(to);
        mapper.updateAccount(to,money2+money);
    &#125;
&#125;
</code></pre>
<h4 id="测试使用"><a class="markdownIt-Anchor" href="#测试使用"></a> 测试使用</h4>
<pre><code class="highlight java"><span class="keyword">import</span> com.lee.service.AccountService;
<span class="keyword">import</span> com.lee.service.AccountServiceImpl;
<span class="keyword">import</span> org.junit.runner.RunWith;
<span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;
<span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

<span class="keyword">import</span> javax.annotation.Resource;

<span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span>
<span class="meta">@ContextConfiguration(&quot;classpath:spring/applicationContext-*.xml&quot;)</span>
<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;

    <span class="comment">//这里使用AccountServiceImpl service;无法注入的原因是：开启事务AOP后，该类被切入，是根据接口生成的代理类，所以无法给AccountServiceImpl赋值，只可以赋值给接口</span>
    <span class="meta">@Resource</span>
    AccountService service;
    
    <span class="meta">@org</span>.junit.Test
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;
        service.transfor(<span class="string">&quot;李博&quot;</span>,<span class="string">&quot;李菊&quot;</span>,<span class="number">200</span>);
    &#125;
&#125;
</code></pre></main>

</article>


<script src="/js/highlight.js"></script>

  </main>
  <footer class="footer">
  
  <span>Copyright © 2026 Lism Blog | lisisism@qq.com</span>
  
</footer>
  
<script src="/js/theme.js"></script>

</body>

</html>