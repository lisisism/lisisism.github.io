<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <title>
    
    Log4j 丨
    

    Lism Blog
  </title>

  
  <link rel="shortcut icon" href="/icon.svg">
  

  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  
  <link id="theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.css">
  <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
  

  <!-- 字体 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">

  
<link rel="stylesheet" href="/css/root.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/post.css">

<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="/Lism Blog" type="application/atom+xml">
</head>

<body>
  <header class="header">
  <section class="header-container">
    <a class="logo" href="/">/Lism Blog</a>
    <ul class="nav">
      
      <li><a href="/archives">archives</a></li>
      
      <li><a href="/about">about</a></li>
      
    </ul>
  </section>
</header>
  <main class="main">
    <article class="post">
  
  <div class="post-title">Log4j</div>
  <div class="post-meta">
    <div class="date">2020 一月 8日</div>
    <div class="tags">
      
      <div class="tag-item">Java</div>
      
      <div class="tag-item">Log4j</div>
      
    </div>
  </div>
  

  <main class="post-content"><h1 id="log4j"><a class="markdownIt-Anchor" href="#log4j"></a> Log4j</h1>
<p>[TOC]</p>
<h2 id="log4j-入门"><a class="markdownIt-Anchor" href="#log4j-入门"></a> log4j 入门</h2>
<h4 id="systemoutprintln"><a class="markdownIt-Anchor" href="#systemoutprintln"></a> System.out.println</h4>
<ul>
<li>缺点
<ol>
<li>不知道这句话是在哪个类，哪个线程里出来的</li>
<li>不知道什么时候前后两句输出间隔了多少时间</li>
<li>无法关闭调试信息，一旦System.out.println多了之后，到处都是输出，增加定位自己需要信息的难度</li>
</ol>
</li>
</ul>
<h4 id="使用log4j"><a class="markdownIt-Anchor" href="#使用log4j"></a> 使用log4j</h4>
<ul>
<li>log4j就解决了上述的痛点
<ol>
<li>知道是log4j.TestLog4j这个类里的日志</li>
<li>是在[main]线程里的日志</li>
<li>日志级别可观察，一共有6个级别 TRACE DEBUG INFO WARN ERROR FATAL</li>
<li>日志输出级别范围可控制， 如代码所示，只输出高于DEBUG级别的，那么TRACE级别的日志自动不输出</li>
<li>每句日志消耗的毫秒数(最前面的数字)，可观察，这样就可以进行性能计算</li>
</ol>
</li>
</ul>
<h5 id="导入jar包"><a class="markdownIt-Anchor" href="#导入jar包"></a> 导入jar包</h5>
<ul>
<li></li>
</ul>
<h5 id="使用"><a class="markdownIt-Anchor" href="#使用"></a> 使用</h5>
<pre><code class="highlight Java"><span class="keyword">package</span> log4jTest;

<span class="keyword">import</span> org.apache.log4j.BasicConfigurator;
<span class="keyword">import</span> org.apache.log4j.Level;
<span class="keyword">import</span> org.apache.log4j.Logger;

<span class="comment">/**</span>
<span class="comment"> * Created by liboar on 2019/5/29.</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;
    <span class="comment">//基于类对象获取日志对象</span>
    <span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> Logger.getLogger(Test.class);
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;
        <span class="comment">//进行默认配置</span>
        BasicConfigurator.configure();
        <span class="comment">//设置日志输出级别</span>
        logger.setLevel(Level.DEBUG);
        <span class="comment">//进行不同级别的日志输出</span>
        logger.trace(<span class="string">&quot;跟踪信息&quot;</span>);
        logger.debug(<span class="string">&quot;调试信息&quot;</span>);
        logger.info(<span class="string">&quot;输出信息&quot;</span>);

        logger.warn(<span class="string">&quot;警告信息&quot;</span>);
        logger.error(<span class="string">&quot;错误信息&quot;</span>);
        logger.fatal(<span class="string">&quot;致命信息&quot;</span>);
    &#125;
&#125;
</code></pre>
<h2 id="log4j-配置详解"><a class="markdownIt-Anchor" href="#log4j-配置详解"></a> log4j 配置详解</h2>
<h4 id="定义log4jproperties"><a class="markdownIt-Anchor" href="#定义log4jproperties"></a> 定义log4j.properties</h4>
<ul>
<li>在src目录下添加log4j.properties文件</li>
<li></li>
</ul>
<pre><code class="highlight properties"><span class="comment"># 设置日志输出的等级为debug,低于debug即不会输出了</span>
<span class="comment"># 设置日志输出到两种地方，分别叫做 stdout 和 R</span>
<span class="attr">log4j.rootLogger</span>=<span class="string">debug, stdout, R</span>
<span class="comment"># 第一个地方stdout</span>
<span class="comment"># 输出到控制台 %5p [%t] (%F:%L) - %m%n</span>
<span class="attr">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender</span>
<span class="attr">log4j.appender.stdout.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span>
<span class="comment"></span>
<span class="comment"># Pattern to output the caller&#x27;s file name and line number.</span>
<span class="attr">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%5p [%t] (%F:%L) - %m%n</span>
<span class="comment"></span>
<span class="comment"># 第二个地方R</span>
<span class="comment"># 以滚动的方式输出到文件，文件名是example.log,文件最大100kb,最多滚动5各文件</span>
<span class="attr">log4j.appender.R</span>=<span class="string">org.apache.log4j.RollingFileAppender</span>
<span class="attr">log4j.appender.R.File</span>=<span class="string">example.log</span>

<span class="attr">log4j.appender.R.MaxFileSize</span>=<span class="string">100KB</span>
<span class="attr">log4j.appender.R.MaxBackupIndex</span>=<span class="string">5</span>
<span class="comment"># 输出格式为 %p %t %c - %m%n</span>
<span class="attr">log4j.appender.R.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span>
<span class="attr">log4j.appender.R.layout.ConversionPattern</span>=<span class="string">%p %t %c - %m%n</span></code></pre>
<h4 id="定义log4jxml"><a class="markdownIt-Anchor" href="#定义log4jxml"></a> 定义log4j.xml</h4>
<ul>
<li>log4j.xml和log4j.properties是<strong>相同的效果</strong></li>
<li>选择一个即可</li>
</ul>
<pre><code class="highlight xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span>
<span class="meta">&lt;!DOCTYPE <span class="keyword">log4j</span>:configuration <span class="keyword">PUBLIC</span> <span class="string">&quot;-//log4j/log4j Configuration//EN&quot;</span> <span class="string">&quot;log4j.dtd&quot;</span>&gt;</span>
  
<span class="tag">&lt;<span class="name">log4j:configuration</span> <span class="attr">xmlns:log4j</span>=<span class="string">&quot;http://jakarta.apache.org/log4j/&quot;</span>&gt;</span>
      
    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.log4j.ConsoleAppender&quot;</span>&gt;</span>
       <span class="tag">&lt;<span class="name">layout</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.log4j.PatternLayout&quot;</span>&gt;</span>
          <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;ConversionPattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;%d %-5p %c.%M:%L - %m%n&quot;</span>/&gt;</span>
       <span class="tag">&lt;/<span class="name">layout</span>&gt;</span>
    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span>
   
    <span class="comment">&lt;!-- specify the logging level for loggers from other libraries --&gt;</span>
    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;com.opensymphony&quot;</span>&gt;</span>
        <span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;ERROR&quot;</span> /&gt;</span>
    <span class="tag">&lt;/<span class="name">logger</span>&gt;</span>
  
    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache&quot;</span>&gt;</span>
         <span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;ERROR&quot;</span> /&gt;</span>
    <span class="tag">&lt;/<span class="name">logger</span>&gt;</span>
    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;org.hibernate&quot;</span>&gt;</span>
         <span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;ERROR&quot;</span> /&gt;</span>
    <span class="tag">&lt;/<span class="name">logger</span>&gt;</span>
    
   <span class="comment">&lt;!-- for all other loggers log only debug and above log messages --&gt;</span>
     <span class="tag">&lt;<span class="name">root</span>&gt;</span>
        <span class="tag">&lt;<span class="name">priority</span> <span class="attr">value</span>=<span class="string">&quot;ERROR&quot;</span>/&gt;</span>
        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span> /&gt;</span>
     <span class="tag">&lt;/<span class="name">root</span>&gt;</span>
      
<span class="tag">&lt;/<span class="name">log4j:configuration</span>&gt;</span></code></pre>
<h4 id="配置使用"><a class="markdownIt-Anchor" href="#配置使用"></a> 配置使用</h4>
<ul>
<li>上一个例子采用默认配置</li>
<li>这次使用自定义配置文件配置log4j输出格式</li>
</ul>
<pre><code class="highlight java"><span class="keyword">package</span> log4jTest;

<span class="keyword">import</span> org.apache.log4j.Logger;
<span class="keyword">import</span> org.apache.log4j.PropertyConfigurator;

<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;
    <span class="comment">//基于类对象获取日志对象</span>
    <span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> Logger.getLogger(Test.class);
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;
        <span class="comment">//指定配置文件路径</span>
        <span class="comment">//与上一个例子不同，这里采用指定配置文件</span>
        PropertyConfigurator.configure(<span class="string">&quot;D:\\leeGit\\MyBatisDemo\\src\\log4j.properties&quot;</span>);
        <span class="comment">//输出格式有变化，会输出哪个类，第几行</span>
        <span class="comment">//还会把输出信息打印到D:\leeGit\MyBatisDemo\example.log 这个位置</span>
        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5000</span>; i++) &#123;
            logger.trace(<span class="string">&quot;跟踪信息&quot;</span>);
            logger.debug(<span class="string">&quot;调试信息&quot;</span>);
            logger.info(<span class="string">&quot;输出信息&quot;</span>);
            logger.warn(<span class="string">&quot;警告信息&quot;</span>);
            logger.error(<span class="string">&quot;错误信息&quot;</span>);
            logger.fatal(<span class="string">&quot;致命信息&quot;</span>);
        &#125;
    &#125;
&#125;</code></pre>
<h4 id="日志输出格式"><a class="markdownIt-Anchor" href="#日志输出格式"></a> 日志输出格式</h4>
<p>log4j日志输出格式一览：</p>
<ul>
<li><code>%c </code>输出日志信息所属的类的全名</li>
<li><code>%d </code>输出日志时间点的日期或时间，默认格式为ISO8601，也可以在其后指定格式，比如：%d{yyy-MM-dd HH:mm:ss }，输出类似：2002-10-18- 22：10：28</li>
<li><code>%f </code>输出日志信息所属的类的类名</li>
<li><code>%l </code>输出日志事件的发生位置，即输出日志信息的语句处于它所在的类的第几行</li>
<li><code>%m </code>输出代码中指定的信息，如log(message)中的message</li>
<li><code>%n </code>输出一个回车换行符，Windows平台为“rn”，Unix平台为“n”</li>
<li><code>%p </code>输出优先级，即DEBUG，INFO，WARN，ERROR，FATAL。如果是调用debug()输出的，则为DEBUG，依此类推</li>
<li><code>%r </code>输出自应用启动到输出该日志信息所耗费的毫秒数</li>
<li><code>%t </code>输出产生该日志事件的线程名</li>
</ul>
<blockquote>
<p>所以：%5p [%t] (%F:%L) - %m%n 就表示：宽度是5的优先等级 线程名称（文件名:行号）- 信息 回车换行</p>
</blockquote>
</main>

</article>


<script src="/js/highlight.js"></script>

  </main>
  <footer class="footer">
  
  <span>Copyright © 2026 Lism Blog | lisisism@qq.com</span>
  
</footer>
  
<script src="/js/theme.js"></script>

</body>

</html>